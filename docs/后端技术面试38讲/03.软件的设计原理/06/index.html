<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-backend/umi.3ec1f225.css" />
    <script>
      window.routerBase = "/blog-backend";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>13丨软件设计的里氏替换原则：正方形可以继承长方形吗？ - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/后端技术面试38讲/03.软件的设计原理/06" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-backend/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>后端开发<ul><li><a href="/blog-backend/go语言核心36讲">go语言核心36讲</a></li><li><a href="/blog-backend/go并发编程实战">go并发编程实战</a></li><li><a href="/blog-backend/go语言项目开发实战">go语言项目开发实战</a></li><li><a href="/blog-backend/kafka核心技术与实战">kafka核心技术与实战</a></li><li><a href="/blog-backend/kafka核心源码解读">kafka核心源码解读</a></li><li><a href="/blog-backend/零基础学python">零基础学python</a></li><li><a href="/blog-backend/python核心技术与实战">python核心技术与实战</a></li><li><a href="/blog-backend/redis核心技术与实战">redis核心技术与实战</a></li><li><a href="/blog-backend/redis源码剖析与实战">redis源码剖析与实战</a></li><li><a href="/blog-backend/陈天rust编程第一课">陈天rust编程第一课</a></li><li><a href="/blog-backend/tonybaigo语言第一课">tonybaigo语言第一课</a></li><li><a href="/blog-backend/后端存储实战课">后端存储实战课</a></li><li><a aria-current="page" class="active" href="/blog-backend/后端技术面试38讲">后端技术面试38讲</a></li><li><a href="/blog-backend/深入c语言和程序运行原理">深入c语言和程序运行原理</a></li><li><a href="/blog-backend/现代c编程实战">现代c编程实战</a></li><li><a href="/blog-backend/罗剑锋的c实战笔记">罗剑锋的c实战笔记</a></li><li><a href="/blog-backend/零基础入门spark">零基础入门spark</a></li></ul></span><span>架构师<ul><li><a href="/blog-backend/mysql实战45讲">mysql实战45讲</a></li><li><a href="/blog-backend/数据中台实战课">数据中台实战课</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-backend/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>后端开发<ul><li><a href="/blog-backend/go语言核心36讲">go语言核心36讲</a></li><li><a href="/blog-backend/go并发编程实战">go并发编程实战</a></li><li><a href="/blog-backend/go语言项目开发实战">go语言项目开发实战</a></li><li><a href="/blog-backend/kafka核心技术与实战">kafka核心技术与实战</a></li><li><a href="/blog-backend/kafka核心源码解读">kafka核心源码解读</a></li><li><a href="/blog-backend/零基础学python">零基础学python</a></li><li><a href="/blog-backend/python核心技术与实战">python核心技术与实战</a></li><li><a href="/blog-backend/redis核心技术与实战">redis核心技术与实战</a></li><li><a href="/blog-backend/redis源码剖析与实战">redis源码剖析与实战</a></li><li><a href="/blog-backend/陈天rust编程第一课">陈天rust编程第一课</a></li><li><a href="/blog-backend/tonybaigo语言第一课">tonybaigo语言第一课</a></li><li><a href="/blog-backend/后端存储实战课">后端存储实战课</a></li><li><a aria-current="page" class="active" href="/blog-backend/后端技术面试38讲">后端技术面试38讲</a></li><li><a href="/blog-backend/深入c语言和程序运行原理">深入c语言和程序运行原理</a></li><li><a href="/blog-backend/现代c编程实战">现代c编程实战</a></li><li><a href="/blog-backend/罗剑锋的c实战笔记">罗剑锋的c实战笔记</a></li><li><a href="/blog-backend/零基础入门spark">零基础入门spark</a></li></ul></li><li>架构师<ul><li><a href="/blog-backend/mysql实战45讲">mysql实战45讲</a></li><li><a href="/blog-backend/数据中台实战课">数据中台实战课</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-backend/后端技术面试38讲">后端技术面试38讲</a></li><li><a href="/blog-backend/后端技术面试38讲/01.开篇词">01.开篇词</a><ul><li><a href="/blog-backend/后端技术面试38讲/01.开篇词/01"><span>开篇词 | 掌握软件开发技术的第一性原理</span></a></li></ul></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理">02.软件的基础原理</a><ul><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/01"><span>01丨程序运行原理：程序是如何运行又是如何崩溃的？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/02"><span>02丨数据结构原理：Hash表的时间复杂度为什么是O(1)？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/03"><span>03丨Java虚拟机原理：JVM为什么被称为机器（machine）？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/04"><span>04丨网络编程原理：一个字符的互联网之旅</span></a></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/05"><span>05丨文件系统原理：如何用1分钟遍历一个100TB的文件？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/06"><span>06丨数据库原理：为什么PrepareStatement性能更好更安全？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/07"><span>07丨编程语言原理：面向对象编程是编程的终极形态吗？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/02.软件的基础原理/08"><span>答疑丨Java Web程序的运行时环境到底是怎样的？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-backend/后端技术面试38讲/03.软件的设计原理">03.软件的设计原理</a><ul><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/01"><span>08丨软件设计的方法论：软件为什么要建模？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/02"><span>09丨软件设计实践：如何使用UML完成一个设计文档？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/03"><span>10 | 软件设计的目的：糟糕的程序员比优秀的程序员差在哪里？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/04"><span>11丨软件设计的开闭原则：如何不修改代码却能实现需求变更？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/05"><span>12 | 软件设计的依赖倒置原则：如何不依赖代码却可以复用它的功能？</span></a></li><li><a aria-current="page" class="active" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06"><span>13丨软件设计的里氏替换原则：正方形可以继承长方形吗？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/07"><span>14 | 软件设计的单一职责原则：为什么说一个类文件打开最好不要超过一屏？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/08"><span>15丨软件设计的接口隔离原则：如何对类的调用者隐藏类的公有方法？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/09"><span>16 | 设计模式基础：不会灵活应用设计模式，你就没有掌握面向对象编程</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/10"><span>17 | 设计模式应用：编程框架中的设计模式</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/11"><span>18 | 反应式编程框架设计：如何使程序调用不阻塞等待，立即响应？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/12"><span>19 | 组件设计原则：组件的边界在哪里？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/13"><span>20 | 领域驱动设计：35岁的程序员应该写什么样的代码？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/14"><span>答疑丨对于设计模式而言，场景到底有多重要？</span></a></li></ul></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理">04.架构的核心原理</a><ul><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/01"><span>21丨分布式架构：如何应对高并发的用户请求</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/02"><span>22 | 缓存架构：如何减少不必要的计算？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/03"><span>23 | 异步架构：如何避免互相依赖的系统间耦合？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/04"><span>24 | 负载均衡架构：如何用10行代码实现一个负载均衡服务？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/05"><span>25 | 数据存储架构：如何改善系统的数据存储能力？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/06"><span>26 | 搜索引擎架构：如何瞬间完成海量数据检索？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/07"><span>27 | 微服务架构：微服务究竟是灵丹还是毒药？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/08"><span>28 | 高性能架构：除了代码，你还可以在哪些地方优化性能？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/09"><span>29 | 高可用架构：我们为什么感觉不到淘宝应用升级时的停机？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/10"><span>30 | 安全性架构：为什么说用户密码泄漏是程序员的锅？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/11"><span>31 | 大数据架构：大数据技术架构的思想和原理是什么？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/12"><span>32 | AI与物联网架构：从智能引擎到物联网平台</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/13"><span>33 | 区块链技术架构：区块链到底能做什么？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/04.架构的核心原理/14"><span>答疑丨互联网需要解决的技术问题是什么？</span></a></li></ul></li><li><a href="/blog-backend/后端技术面试38讲/05.技术人的思维修炼">05.技术人的思维修炼</a><ul><li><a href="/blog-backend/后端技术面试38讲/05.技术人的思维修炼/01"><span>34 | 技术修炼之道：同样工作十几年，为什么有的人成为大厂架构师，有的人失业？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/05.技术人的思维修炼/02"><span>35 | 技术进阶之道：你和这个星球最顶级的程序员差几个等级？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/05.技术人的思维修炼/03"><span>36丨技术落地之道：你真的知道自己要解决的问题是什么吗？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/05.技术人的思维修炼/04"><span>37丨技术沟通之道：如何解决问题？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/05.技术人的思维修炼/05"><span>38丨技术管理之道：你真的要转管理吗？</span></a></li><li><a href="/blog-backend/后端技术面试38讲/05.技术人的思维修炼/06"><span>答疑丨工作中的交往和沟通，都有哪些小技巧呢？</span></a></li></ul></li><li><a href="/blog-backend/后端技术面试38讲/06.不定期加餐">06.不定期加餐</a><ul><li><a href="/blog-backend/后端技术面试38讲/06.不定期加餐/01"><span>加餐 | 软件设计文档示例模板</span></a></li></ul></li><li><a href="/blog-backend/后端技术面试38讲/07.结束语">07.结束语</a><ul><li><a href="/blog-backend/后端技术面试38讲/07.结束语/01"><span>结束语丨期待未来的你，成为优秀的软件架构师</span></a></li></ul></li><li><a href="/blog-backend/后端技术面试38讲/08.期末考试">08.期末考试</a><ul><li><a href="/blog-backend/后端技术面试38讲/08.期末考试/01"><span>期末测试丨快来测测你对专栏内容掌握到何种程度了</span></a></li></ul></li><li><a href="/blog-backend/后端技术面试38讲/summary">后端技术面试38讲</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="里氏替换原则" data-depth="2"><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#里氏替换原则"><span>里氏替换原则</span></a></li><li title="一个违反里氏替换规则的例子" data-depth="2"><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#一个违反里氏替换规则的例子"><span>一个违反里氏替换规则的例子</span></a></li><li title="正方形可以继承长方形吗？" data-depth="2"><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#正方形可以继承长方形吗"><span>正方形可以继承长方形吗？</span></a></li><li title="子类不能比父类更严格" data-depth="2"><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#子类不能比父类更严格"><span>子类不能比父类更严格</span></a></li><li title="小结" data-depth="2"><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#小结"><span>小结</span></a></li><li title="思考题" data-depth="2"><a href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="13丨软件设计的里氏替换原则正方形可以继承长方形吗"><a aria-hidden="true" tabindex="-1" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#13丨软件设计的里氏替换原则正方形可以继承长方形吗"><span class="icon icon-link"></span></a>13丨软件设计的里氏替换原则：正方形可以继承长方形吗？</h1><p>我们都知道，面向对象编程语言有三大特性：封装、继承、多态。这几个特性也许可以很快就学会，但是如果想要用好，可能要花非常多的时间。</p><p>通俗地说，接口（抽象类）的多个实现就是多态。多态可以让程序在编程时面向接口进行编程，在运行期绑定具体类，从而使得类之间不需要直接耦合，就可以关联组合，构成一个更强大的整体对外服务。绝大多数设计模式其实都是利用多态的特性玩的把戏，前面两篇学习的开闭原则和依赖倒置原则也是利用多态的特性。正是多态使得编程有时候像变魔术，如果能用好多态，可以说掌握了大多数的面向对象编程技巧。</p><p>封装是面向对象语言提供的特性，将属性和方法封装在类里面。用好封装的关键是，知道应该将哪些属性和方法封装在某个类里。一个方法应该封装进A类里，还是B类里？这个问题其实就是如何进行对象的设计。深入研究进去，里面也有大量的学问。</p><p>继承似乎比多态和封装要简单一些，但实践中，继承的误用也很常见。</p><h2 id="里氏替换原则"><a aria-hidden="true" tabindex="-1" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#里氏替换原则"><span class="icon icon-link"></span></a>里氏替换原则</h2><p>关于如何设计类的继承关系，怎样使继承不违反开闭原则，实际上有一个关于继承的设计原则，叫里氏替换原则。这个原则说：若对每个类型T1的对象o1，都存在一个类型T2的对象o2，使得在所有针对T2编写的程序P中，用o1替换o2后，程序P的行为功能不变，则T1是T2的子类型。</p><p>上面这句话比较学术，通俗地说就是：<strong>子类型必须能够替换掉它们的基类型</strong>。</p><p>再稍微详细点说，就是：程序中，所有使用基类的地方，都应该可以用子类代替。</p><p>语法上，任何类都可以被继承。但是一个继承是否合理，从继承关系本身是看不出来的，需要把继承放在应用场景的上下文中去判断，使用基类的地方，是否可以用子类代替？</p><p>这里有一个马的继承设计：</p><p><img src="data:image/png;base64,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" alt=""/></p><p>白马和小马驹都是马，所以都继承了马。这样的继承是不是合理呢？我们需要放到应用场景中：</p><p><img src="data:image/png;base64,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" alt=""/></p><p>在这个场景中，是人骑马。根据这里的关系，继承了马的白马和小马驹，应该都可以代替马。白马代替马当然没有问题，人可以骑白马，但是小马驹代替马可能就不合适了，因为小马驹还没长好，无法被人骑。</p><p>那么很显然，作为子类的白马可以替换掉基类马，但是小马不能替换马，因此小马继承马就不太合适了，违反了里氏替换原则。</p><h2 id="一个违反里氏替换规则的例子"><a aria-hidden="true" tabindex="-1" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#一个违反里氏替换规则的例子"><span class="icon icon-link"></span></a>一个违反里氏替换规则的例子</h2><p>我们再看这样一段代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">void drawShape(Shape shape) {</span></div><div class="token-line"><span class="token plain">        if (shape.type == Shape.Circle ) {</span></div><div class="token-line"><span class="token plain">            drawCircle((Circle) shape);</span></div><div class="token-line"><span class="token plain">        } else if (shape.type == Shape.Square) {</span></div><div class="token-line"><span class="token plain">            drawSquare((Square) shape);</span></div><div class="token-line"><span class="token plain">        } else {</span></div><div class="token-line"><span class="token plain">            ……</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这里Circle和Square继承了基类Shape，然后在应用的方法中，根据输入Shape对象类型进行判断，根据对象类型选择不同的绘图函数将图形画出来。这种写法的代码既常见又糟糕，它同时违反了开闭原则和里氏替换原则。</p><p>首先看到这样的if/else代码，就可以判断违反了开闭原则：当增加新的Shape类型的时候，必须修改这个方法，增加else if代码。</p><p>其次也因为同样的原因违反了里氏替换原则：当增加新的Shape类型的时候，如果没有修改这个方法，没有增加else if代码，那么这个新类型就无法替换基类Shape。</p><p>要解决这个问题其实也很简单，只需要在基类Shape中定义draw方法，所有Shape的子类，Circle、Square都实现这个方法就可以了：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">public abstract Shape{</span></div><div class="token-line"><span class="token plain">      public abstract void draw();</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>上面那段drawShape()代码也就可以变得更简单：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">void drawShape(Shape shape) {</span></div><div class="token-line"><span class="token plain">      shape.draw();</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这段代码既满足开闭原则：增加新的类型不需要修改任何代码。也满足里氏替换原则：在使用基类的这个方法中，可以用子类替换，程序正常运行。</p><h2 id="正方形可以继承长方形吗"><a aria-hidden="true" tabindex="-1" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#正方形可以继承长方形吗"><span class="icon icon-link"></span></a>正方形可以继承长方形吗？</h2><p>一个继承设计是否违反里氏替换原则，需要在具体场景中考察。我们再看一个例子，假设我们现在有一个长方形的类，类定义如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">public class Rectangle {</span></div><div class="token-line"><span class="token plain">        private double width;</span></div><div class="token-line"><span class="token plain">        private double height;</span></div><div class="token-line"><span class="token plain">        public void setWidth(double w) { width = w; }</span></div><div class="token-line"><span class="token plain">        public void setHeight(double h) { height = h; }</span></div><div class="token-line"><span class="token plain">        public double getWidth() { return width; }</span></div><div class="token-line"><span class="token plain">        public double getHeight() { return height; }</span></div><div class="token-line"><span class="token plain">        public double calculateArea() {return width * height;}</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这个类满足我们的应用场景，在程序中多个地方被使用，一切良好。但是现在，我们有个新需求，我们还需要一个正方形。</p><p>通常，我们判断一个继承是否合理，会使用“IS A”进行判断，类B可以继承类A，我们就说类B IS A 类A，比如白马IS A 马，轿车 IS A 车。</p><p>那正方形是不是IS A长方形呢？通常我们会说，正方形是一种特殊的长方形，是长和宽相等的长方形，从这个角度讲，那么正方形IS A长方形，也就是可以继承长方形。</p><p>具体实现上，我们只需要在设置长方形的长或宽的时候，同时设置长和宽就可以了，如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">public class Square extends Rectangle {</span></div><div class="token-line"><span class="token plain">        public void setWidth(double w) {</span></div><div class="token-line"><span class="token plain">            width = height = w;</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">        public void setHeight(double h) {</span></div><div class="token-line"><span class="token plain">            height = width = w;</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这个正方形类设计看起来很正常，用起来似乎也没有问题。但是，真的没有问题吗？</p><p>继承是否合理我们需要用里氏替换原则来判断。之前也说过，是否合理并不是从继承的设计本身看，而是从应用场景的角度看。如果在应用场景中，也就是在程序中，子类可以替换父类，那么继承就是合理的，如果不能替换，那么继承就是不合理的。</p><p>这个长方形的使用场景是什么样的呢，我们看使用代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">void testArea(Rectangle rect) {</span></div><div class="token-line"><span class="token plain">        rect.setWidth(3);</span></div><div class="token-line"><span class="token plain">        rect.setHeight(4);</span></div><div class="token-line"><span class="token plain">        assert 12 == rect.calculateArea(); </span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>显然，在这个场景中，如果用子类Square替换父类Rectangle，计算面积calculateArea将返回16，而不是12，程序是不能正确运行的，这样的继承不满足里氏替换原则，是不合适的继承。</p><h2 id="子类不能比父类更严格"><a aria-hidden="true" tabindex="-1" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#子类不能比父类更严格"><span class="icon icon-link"></span></a>子类不能比父类更严格</h2><p>类的公有方法其实是对使用者的一个契约，使用者按照这个契约使用类，并期望类按照契约运行，返回合理的值。</p><p>当子类继承父类的时候，根据里氏替换原则，使用者可以在使用父类的地方使用子类替换，那么从契约的角度，子类的契约就不能比父类更严格，否则使用者在用子类替换父类的时候，就会因为更严格的契约而失败。</p><p>在上面这个例子中，正方形继承了长方形，但是正方形有比长方形更严格的契约，即正方形要求长和宽是一样的。因为正方形有比长方形更严格的契约，那么在使用长方形的地方，正方形因为更严格的契约而无法替换长方形。</p><p>我们开头小马继承马的例子也是如此，小马比马有更严格的要求，即不能骑，那么小马继承马就是不合适的。</p><p>在类的继承中，如果父类方法的访问控制是protected，那么子类override这个方法的时候，可以改成是public，但是不能改成private。因为private的访问控制比protected更严格，能使用父类protected方法的地方，不能用子类的private方法替换，否则就是违反里氏替换原则的。相反，如果子类方法的访问控制改成public就没问题，即子类可以有比父类更宽松的契约。同样，子类override父类方法的时候，不能将父类的public方法改成protected，否则会出现编译错误。</p><p>通常说来，子类比父类的契约更严格，都是违反里氏替换原则的。</p><p>子类不应该比父类更严格，这个原则看起来既合理又简单，但是在实际中，如果你不严谨地审视自己的设计，是很可能违背里氏替换原则的。</p><p>在JDK中，类Properties继承自类Hashtable，类Stack继承自Vector。</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage48c4489a0c187c2f89ca7aee52cba59816c4.f78b0bd9.png" alt=""/></p><p>这样的设计，其实是违反里氏替换原则的。Properties要求处理的数据类型是String，而它的父类Hashtable要求处理的数据类型是Object，子类比父类的契约更严格；Stack是一个栈数据结构，数据只能后进先出，而它的父类Vector是一个线性表，子类比父类的契约更严格。</p><p>这两个类都是从JDK1就已经存在的，我想，如果能够重新再来，JDK的工程师一定不会这样设计。这也从另一个方面说明，不恰当的继承是很容易就发生的，设计继承的时候，需要更严谨的审视。</p><h2 id="小结"><a aria-hidden="true" tabindex="-1" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#小结"><span class="icon icon-link"></span></a>小结</h2><p>实践中，当你继承一个父类仅仅是为了复用父类中的方法的时候，那么很有可能你离错误的继承已经不远了。一个类如果不是为了被继承而设计，那么最好就不要继承它。粗暴一点地说，如果不是抽象类或者接口，最好不要继承它。</p><p>如果你确实需要使用一个类的方法，最好的办法是组合这个类而不是继承这个类，这就是人们通常说的<strong>组合优于继承</strong>。比如这样：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">Class A{</span></div><div class="token-line"><span class="token plain">     public Element query(int id){...}</span></div><div class="token-line"><span class="token plain">     public void modify(Element e){...}</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    Class B{</span></div><div class="token-line"><span class="token plain">      private A a;</span></div><div class="token-line"><span class="token plain">      public Element select(int id){</span></div><div class="token-line"><span class="token plain">        a.query(id);</span></div><div class="token-line"><span class="token plain">      } </span></div><div class="token-line"><span class="token plain">       public void modify(Element e){</span></div><div class="token-line"><span class="token plain">         a.modify(e);</span></div><div class="token-line"><span class="token plain">       }</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>如果类B需要使用类A的方法，这时候不要去继承类A，而是去组合类A，也能达到使用类A方法的效果。这其实就是<strong>对象适配器模式</strong>了，使用这个模式的话，类B不需要继承类A，一样可以拥有类A的方法，同时还有更大的灵活性，比如可以改变方法的名称以适应应用接口的需要。</p><p>当然，继承接口或者抽象类也并不保证你的继承设计就是正确的，最好的方法还是用里氏替换原则检查一下你的设计：使用父类的地方是不是可以用子类替换？</p><p>违反里氏替换原则不仅仅发生在设计继承的地方，也可能发生在使用父类和子类的地方，错误的使用方法，也可能导致程序违反里氏替换原则，使子类无法替换父类。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog-backend/后端技术面试38讲/03.软件的设计原理/06#思考题"><span class="icon icon-link"></span></a>思考题</h2><p>下面给你留一道思考题吧。</p><p>父类中有抽象方法f，抛出异常AException：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">public abstract void f() throws AException;</span></div></pre></div><p>子类override父类这个方法后，想要将抛出的异常改为BException，那么BException应该是AException的父类还是子类？</p><p>为什么呢？请你用里氏替换原则说明，并在评论区写下你的思考，我会和你一起交流，也欢迎你把这篇文章分享给你的朋友或者同事，一起交流一下。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/后端技术面试38讲/03.软件的设计原理/06.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/27 11:15:40</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-backend/umi.e14e5a14.js"></script>
  </body>
</html>
