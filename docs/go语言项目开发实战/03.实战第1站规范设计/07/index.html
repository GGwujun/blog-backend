<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-backend/umi.3ec1f225.css" />
    <script>
      window.routerBase = "/blog-backend";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>10 | 设计方法：怎么写出优雅的 Go 项目？ - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/go语言项目开发实战/03.实战第1站规范设计/07" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-backend/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>后端开发<ul><li><a href="/blog-backend/go语言核心36讲">go语言核心36讲</a></li><li><a href="/blog-backend/go并发编程实战">go并发编程实战</a></li><li><a aria-current="page" class="active" href="/blog-backend/go语言项目开发实战">go语言项目开发实战</a></li><li><a href="/blog-backend/kafka核心技术与实战">kafka核心技术与实战</a></li><li><a href="/blog-backend/kafka核心源码解读">kafka核心源码解读</a></li><li><a href="/blog-backend/零基础学python">零基础学python</a></li><li><a href="/blog-backend/python核心技术与实战">python核心技术与实战</a></li><li><a href="/blog-backend/redis核心技术与实战">redis核心技术与实战</a></li><li><a href="/blog-backend/redis源码剖析与实战">redis源码剖析与实战</a></li><li><a href="/blog-backend/陈天rust编程第一课">陈天rust编程第一课</a></li><li><a href="/blog-backend/tonybaigo语言第一课">tonybaigo语言第一课</a></li><li><a href="/blog-backend/后端存储实战课">后端存储实战课</a></li><li><a href="/blog-backend/后端技术面试38讲">后端技术面试38讲</a></li><li><a href="/blog-backend/深入c语言和程序运行原理">深入c语言和程序运行原理</a></li><li><a href="/blog-backend/现代c编程实战">现代c编程实战</a></li><li><a href="/blog-backend/罗剑锋的c实战笔记">罗剑锋的c实战笔记</a></li><li><a href="/blog-backend/零基础入门spark">零基础入门spark</a></li></ul></span><span>架构师<ul><li><a href="/blog-backend/mysql实战45讲">mysql实战45讲</a></li><li><a href="/blog-backend/数据中台实战课">数据中台实战课</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-backend/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>后端开发<ul><li><a href="/blog-backend/go语言核心36讲">go语言核心36讲</a></li><li><a href="/blog-backend/go并发编程实战">go并发编程实战</a></li><li><a aria-current="page" class="active" href="/blog-backend/go语言项目开发实战">go语言项目开发实战</a></li><li><a href="/blog-backend/kafka核心技术与实战">kafka核心技术与实战</a></li><li><a href="/blog-backend/kafka核心源码解读">kafka核心源码解读</a></li><li><a href="/blog-backend/零基础学python">零基础学python</a></li><li><a href="/blog-backend/python核心技术与实战">python核心技术与实战</a></li><li><a href="/blog-backend/redis核心技术与实战">redis核心技术与实战</a></li><li><a href="/blog-backend/redis源码剖析与实战">redis源码剖析与实战</a></li><li><a href="/blog-backend/陈天rust编程第一课">陈天rust编程第一课</a></li><li><a href="/blog-backend/tonybaigo语言第一课">tonybaigo语言第一课</a></li><li><a href="/blog-backend/后端存储实战课">后端存储实战课</a></li><li><a href="/blog-backend/后端技术面试38讲">后端技术面试38讲</a></li><li><a href="/blog-backend/深入c语言和程序运行原理">深入c语言和程序运行原理</a></li><li><a href="/blog-backend/现代c编程实战">现代c编程实战</a></li><li><a href="/blog-backend/罗剑锋的c实战笔记">罗剑锋的c实战笔记</a></li><li><a href="/blog-backend/零基础入门spark">零基础入门spark</a></li></ul></li><li>架构师<ul><li><a href="/blog-backend/mysql实战45讲">mysql实战45讲</a></li><li><a href="/blog-backend/数据中台实战课">数据中台实战课</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-backend/go语言项目开发实战">go语言项目开发实战</a></li><li><a href="/blog-backend/go语言项目开发实战/01.开篇词">01.开篇词</a><ul><li><a href="/blog-backend/go语言项目开发实战/01.开篇词/01"><span>开篇词 | 从 0 开始搭建一个企业级 Go 应用</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/02.课前必学">02.课前必学</a><ul><li><a href="/blog-backend/go语言项目开发实战/02.课前必学/01"><span>01 | IAM系统概述：我们要实现什么样的 Go 项目？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/02.课前必学/02"><span>02 | 环境准备：如何安装和配置一个基本的 Go 开发环境？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/02.课前必学/03"><span>03 | 项目部署：如何快速部署 IAM 系统？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计">03.实战第1站规范设计</a><ul><li><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/01"><span>04 | 规范设计（上）：项目开发杂乱无章，如何规范？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/02"><span>05 | 规范设计（下）：commit 信息风格迥异、难以阅读，如何规范？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/03"><span>06 | 目录结构设计：如何组织一个可维护、可扩展的代码目录？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/04"><span>07 | 工作流设计：如何设计合理的多人开发模式？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/05"><span>08 | 研发流程设计（上）：如何设计 Go 项目的开发流程？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/06"><span>09 | 研发流程设计（下）：如何管理应用的生命周期？</span></a></li><li><a aria-current="page" class="active" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07"><span>10 | 设计方法：怎么写出优雅的 Go 项目？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/08"><span>11 | 设计模式：Go常用设计模式概述</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发">04.实战第2站基础功能设计或开发</a><ul><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/01"><span>12 | API 风格（上）：如何设计RESTful API？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/02"><span>13 | API 风格（下）：RPC API介绍</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/03"><span>14 | 项目管理：如何编写高质量的Makefile？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/04"><span>15 | 研发流程实战：IAM项目是如何进行研发流程管理的？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/05"><span>16 | 代码检查：如何进行静态代码检查？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/06"><span>17 | API 文档：如何生成 Swagger API 文档 ？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/07"><span>18 | 错误处理（上）：如何设计一套科学的错误码？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/08"><span>19 | 错误处理（下）：如何设计错误包？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/09"><span>20 | 日志处理（上）：如何设计日志包并记录日志？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/10"><span>21 | 日志处理（下）：手把手教你从 0 编写一个日志包</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/11"><span>22 | 应用构建三剑客：Pflag、Viper、Cobra 核心功能介绍</span></a></li><li><a href="/blog-backend/go语言项目开发实战/04.实战第2站基础功能设计或开发/12"><span>23 | 应用构建实战：如何构建一个优秀的企业应用框架？</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发">05.实战第3站服务开发</a><ul><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/01"><span>24 | Web 服务：Web 服务核心功能有哪些，如何实现？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/02"><span>25 | 认证机制：应用程序如何进行访问认证？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/03"><span>26 | IAM项目是如何设计和实现访问认证功能的？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/04"><span>27 | 权限模型：5大权限模型是如何进行资源授权的？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/05"><span>28 | 控制流（上）：通过iam-apiserver设计，看Web服务的构建</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/06"><span>29｜控制流（下）：iam-apiserver服务核心功能实现讲解</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/07"><span>30 | ORM：CURD 神器 GORM 包介绍及实战</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/08"><span>31 | 数据流：通过iam-authz-server设计，看数据流服务的设计</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/09"><span>32 | 数据处理：如何高效处理应用程序产生的数据？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/10"><span>33 |  SDK 设计（上）：如何设计出一个优秀的 Go SDK？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/11"><span>34 | SDK 设计（下）：IAM项目Go SDK设计和实现</span></a></li><li><a href="/blog-backend/go语言项目开发实战/05.实战第3站服务开发/12"><span>35 | 效率神器：如何设计和实现一个命令行客户端工具？</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/06.实战第4站服务测试">06.实战第4站服务测试</a><ul><li><a href="/blog-backend/go语言项目开发实战/06.实战第4站服务测试/01"><span>36 | 代码测试（上）：如何编写 Go 语言单元测试和性能测试用例？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/06.实战第4站服务测试/02"><span>37 | 代码测试（下）：Go 语言其他测试类型及 IAM 测试介绍</span></a></li><li><a href="/blog-backend/go语言项目开发实战/06.实战第4站服务测试/03"><span>38｜性能分析（上）：如何分析 Go 语言代码的性能？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/06.实战第4站服务测试/04"><span>39｜性能分析（下）：API Server性能测试和调优实战</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署">07.实战第5站服务部署</a><ul><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/01"><span>40 | 软件部署实战（上）：部署方案及负载均衡、高可用组件介绍</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/02"><span>41 | 软件部署实战（中）：IAM 系统生产环境部署实战</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/03"><span>42 | 软件部署实战（下）：IAM系统安全加固、水平扩缩容实战</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/04"><span>43｜技术演进（上）：虚拟化技术演进之路</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/05"><span>44｜技术演进（下）：软件架构和应用生命周期技术演进之路</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/06"><span>45｜基于Kubernetes的云原生架构设计</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/07"><span>46 | 如何制作Docker镜像？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/08"><span>47 | 如何编写Kubernetes资源定义文件？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/09"><span>48 | 基于腾讯云 EKS 的容器化部署实战</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/10"><span>49 | 服务编排（上）：Helm服务编排基础知识</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/11"><span>50 | 服务编排（下）：基于Helm的服务编排部署实战</span></a></li><li><a href="/blog-backend/go语言项目开发实战/07.实战第5站服务部署/12"><span>51 | 基于 GitHub Actions 的 CI 实战</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/08.特别放送">08.特别放送</a><ul><li><a href="/blog-backend/go语言项目开发实战/08.特别放送/01"><span>特别放送 | 给你一份清晰、可直接套用的Go编码规范</span></a></li><li><a href="/blog-backend/go语言项目开发实战/08.特别放送/02"><span>特别放送 | 给你一份Go项目中最常用的Makefile核心语法</span></a></li><li><a href="/blog-backend/go语言项目开发实战/08.特别放送/03"><span>特别放送 | Go Modules依赖包管理全讲</span></a></li><li><a href="/blog-backend/go语言项目开发实战/08.特别放送/04"><span>特别放送 | IAM排障指南</span></a></li><li><a href="/blog-backend/go语言项目开发实战/08.特别放送/05"><span>特别放送 | Go Modules实战</span></a></li><li><a href="/blog-backend/go语言项目开发实战/08.特别放送/06"><span>特别放送 | 分布式作业系统设计和实现</span></a></li><li><a href="/blog-backend/go语言项目开发实战/08.特别放送/07"><span>直播加餐｜如何从小白进阶成 Go 语言专家？</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/09.结束语">09.结束语</a><ul><li><a href="/blog-backend/go语言项目开发实战/09.结束语/01"><span>结束语 | 如何让自己的 Go 研发之路走得更远？</span></a></li><li><a href="/blog-backend/go语言项目开发实战/09.结束语/02"><span>期末考试｜《Go语言项目开发实战》满分试卷，等你来挑战！</span></a></li></ul></li><li><a href="/blog-backend/go语言项目开发实战/summary">go语言项目开发实战</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="如何写出优雅的Go项目？" data-depth="2"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#如何写出优雅的go项目"><span>如何写出优雅的Go项目？</span></a></li><li title="编写高质量的Go应用" data-depth="2"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#编写高质量的go应用"><span>编写高质量的Go应用</span></a></li><li title="代码结构" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#代码结构"><span>代码结构</span></a></li><li title="代码规范" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#代码规范"><span>代码规范</span></a></li><li title="代码质量" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#代码质量"><span>代码质量</span></a></li><li title="编程哲学" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#编程哲学"><span>编程哲学</span></a></li><li title="软件设计方法" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#软件设计方法"><span>软件设计方法</span></a></li><li title="高效管理项目" data-depth="2"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#高效管理项目"><span>高效管理项目</span></a></li><li title="高效的开发流程" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#高效的开发流程"><span>高效的开发流程</span></a></li><li title="使用Makefile管理项目" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#使用makefile管理项目"><span>使用Makefile管理项目</span></a></li><li title="自动生成代码" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#自动生成代码"><span>自动生成代码</span></a></li><li title="善于借助工具" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#善于借助工具"><span>善于借助工具</span></a></li><li title="对接CI/CD" data-depth="3"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#对接cicd"><span>对接CI/CD</span></a></li><li title="编写高质量的项目文档" data-depth="2"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#编写高质量的项目文档"><span>编写高质量的项目文档</span></a></li><li title="总结" data-depth="2"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#总结"><span>总结</span></a></li><li title="课后练习" data-depth="2"><a href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#课后练习"><span>课后练习</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="10--设计方法怎么写出优雅的-go-项目"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#10--设计方法怎么写出优雅的-go-项目"><span class="icon icon-link"></span></a>10 | 设计方法：怎么写出优雅的 Go 项目？</h1><p>你好，我是孔令飞，今天我们来聊聊如何写出优雅的 Go 项目。</p><p>Go语言简单易学，对于大部分开发者来说，编写可运行的代码并不是一件难事，但如果想真正成为Go编程高手，你需要花很多精力去研究Go的编程哲学。</p><p>在我的Go开发生涯中，我见过各种各样的代码问题，例如：代码不规范，难以阅读；函数共享性差，代码重复率高；不是面向接口编程，代码扩展性差，代码不可测；代码质量低下。究其原因，是因为这些代码的开发者<strong>很少花时间去认真研究如何开发一个优雅的Go项目，更多时间是埋头在需求开发中</strong>。</p><p>如果你也遇到过以上问题，那么是时候花点时间来研究下如何开发一个优雅的Go项目了。只有这样，你才能区别于绝大部分的Go开发者，从而在职场上建立自己的核心竞争力，并最终脱颖而出。</p><p>其实，我们之前所学的各种规范设计，也都是为了写出一个优雅的Go项目。在这一讲，我又补充了一些内容，从而形成了一套“写出优雅Go项目”的方法论。这一讲内容比较多，但很重要，希望你能花点精力认真掌握，掌握之后，能够确保你开发出一个优秀的Go项目。</p><h2 id="如何写出优雅的go项目"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#如何写出优雅的go项目"><span class="icon icon-link"></span></a>如何写出优雅的Go项目？</h2><p>那么，如何写出一个<strong>优雅</strong>的<strong>Go项目</strong>呢？在回答这个问题之前，我们先来看另外两个问题：</p><ol><li>为什么是Go项目，而不是Go应用？</li><li>一个优雅的Go项目具有哪些特点？</li></ol><p>先来看第一个问题。Go项目是一个偏工程化的概念，不仅包含了Go应用，还包含了项目管理和项目文档：</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage24aa24ba3548f8574a747b51e291224097aa.f478c287.png" alt=""/></p><p>这就来到了第二个问题，一个优雅的Go项目，不仅要求我们的Go应用是优雅的，还要确保我们的项目管理和文档也是优雅的。这样，我们根据前面几讲学到的Go设计规范，很容易就能总结出一个优雅的Go应用需要具备的特点：</p><ul><li>符合Go编码规范和最佳实践；</li><li>易阅读、易理解，易维护；</li><li>易测试、易扩展；</li><li>代码质量高。</li></ul><p>解决了这两个问题，让我们回到这一讲的核心问题：如何写出优雅的Go项目？</p><p>写出一个优雅的Go项目，在我看来，就是<strong>用“最佳实践”的方式去实现Go项目中的Go应用、项目管理和项目文档</strong>。具体来说，就是编写高质量的Go应用、高效管理项目、编写高质量的项目文档。</p><p>为了协助你理解，我将这些逻辑绘制成了下面一张图。</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage770377d541223576135df4c3d511abbfe603.2ba1f716.png" alt=""/></p><p>接下来，我们就看看如何根据前面几讲学习的Go项目设计规范，实现一个优雅的Go项目。我们先从编写高质量的Go应用看起。</p><h2 id="编写高质量的go应用"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#编写高质量的go应用"><span class="icon icon-link"></span></a>编写高质量的Go应用</h2><p>基于我的研发经验，要编写一个高质量的Go应用，其实可以归纳为5个方面：代码结构、代码规范、代码质量、编程哲学和软件设计方法，见下图。</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage23692392d94feb95d3d64d765abe7d6e5e69.5c3bec48.png" alt=""/></p><p>接下来，我们详细说说这些内容。</p><h3 id="代码结构"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#代码结构"><span class="icon icon-link"></span></a>代码结构</h3><p>为什么先说代码结构呢？因为组织合理的代码结构是一个项目的门面。我们可以通过两个手段来组织代码结构。</p><p>第一个手段是，组织一个好的目录结构。关于如何组合一个好的目录结构，你可以回顾 <a target="_blank" rel="noopener noreferrer" href="https://time.geekbang.org/column/article/381392">06讲<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的内容。</p><p>第二个手段是，选择一个好的模块拆分方法。做好模块拆分，可以使项目内模块职责分明，做到低耦合高内聚。</p><p>那么Go项目开发中，如何拆分模块呢？目前业界有两种拆分方法，分别是按层拆分和按功能拆分。</p><p><strong>首先，我们看下按层拆分</strong>，最典型的是MVC架构中的模块拆分方式。在MVC架构中，我们将服务中的不同组件按访问顺序，拆分成了Model、View和Controller三层。</p><p><img src="data:image/png;base64,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" alt=""/></p><p>每层完成不同的功能：</p><ul><li>View（视图）是提供给用户的操作界面，用来处理数据的显示。</li><li>Controller（控制器），负责根据用户从 View 层输入的指令，选取 Model 层中的数据，然后对其进行相应的操作，产生最终结果。</li><li>Model（模型），是应用程序中用于处理数据逻辑的部分。</li></ul><p>我们看一个典型的按层拆分的目录结构：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ tree --noreport -L 2 layers</span></div><div class="token-line"><span class="token plain">    layers</span></div><div class="token-line"><span class="token plain">    ├── controllers</span></div><div class="token-line"><span class="token plain">    │   ├── billing</span></div><div class="token-line"><span class="token plain">    │   ├── order</span></div><div class="token-line"><span class="token plain">    │   └── user</span></div><div class="token-line"><span class="token plain">    ├── models</span></div><div class="token-line"><span class="token plain">    │   ├── billing.go</span></div><div class="token-line"><span class="token plain">    │   ├── order.go</span></div><div class="token-line"><span class="token plain">    │   └── user.go</span></div><div class="token-line"><span class="token plain">    └── views</span></div><div class="token-line"><span class="token plain">        └── layouts</span></div></pre></div><p>在Go项目中，按层拆分会带来很多问题。最大的问题是循环引用：相同功能可能在不同层被使用到，而这些功能又分散在不同的层中，很容易造成循环引用。</p><p>所以，<strong>你只要大概知道按层拆分是什么意思就够了，在Go项目中我建议你使用的是按功能拆分的方法，这也是Go项目中最常见的拆分方法。</strong></p><p>那什么是按功能拆分呢？我给你看一个例子你就明白了。比如，一个订单系统，我们可以根据不同功能将其拆分成用户（user）、订单（order）和计费（billing）3个模块，每一个模块提供独立的功能，功能更单一：</p><p><img src="data:image/png;base64,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" alt=""/></p><p>下面是该订单系统的代码目录结构：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ tree pkg</span></div><div class="token-line"><span class="token plain">    $ tree --noreport -L 2 pkg</span></div><div class="token-line"><span class="token plain">    pkg</span></div><div class="token-line"><span class="token plain">    ├── billing</span></div><div class="token-line"><span class="token plain">    ├── order</span></div><div class="token-line"><span class="token plain">    │   └── order.go</span></div><div class="token-line"><span class="token plain">    └── user</span></div></pre></div><p>相较于按层拆分，按功能拆分模块带来的好处也很好理解：</p><ul><li>不同模块，功能单一，可以实现高内聚低耦合的设计哲学。</li><li>因为所有的功能只需要实现一次，引用逻辑清晰，会大大减少出现循环引用的概率。</li></ul><p>所以，有很多优秀的Go项目采用的都是按功能拆分的模块拆分方式，例如 Kubernetes、Docker、Helm、Prometheus等。</p><p>除了组织合理的代码结构这种方式外，编写高质量Go应用的另外一个行之有效的方法，是遵循Go语言代码规范来编写代码。在我看来，这也是最容易出效果的方式。</p><h3 id="代码规范"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#代码规范"><span class="icon icon-link"></span></a>代码规范</h3><p>那我们要遵循哪些代码规范来编写Go应用呢？在我看来，其实就两类：编码规范和最佳实践。</p><p><strong>首先，我们的代码要符合Go编码规范，这是最容易实现的途径</strong>。Go社区有很多这类规范可供参考，其中，比较受欢迎的是<a target="_blank" rel="noopener noreferrer" href="https://github.com/xxjwxc/uber_go_guide_cn">Uber Go 语言编码规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><p>阅读这些规范确实有用，也确实花时间、花精力。所以，我在参考了已有的很多规范后，结合自己写Go代码的经验，特地为你整理了一篇Go编码规范作为加餐，也就是“特别放送 | 给你一份清晰、可直接套用的Go编码规范”。</p><p>有了可以参考的编码规范之后，我们需要扩展到团队、部门甚至公司层面。只有大家一起参与、遵守，规范才会变得有意义。其实，我们都清楚，要开发者靠自觉来遵守所有的编码规范，不是一件容易的事儿。这时候，我们可以使用静态代码检查工具，来约束开发者的行为。</p><p>有了静态代码检查工具后，不仅可以确保开发者写出的每一行代码都是符合Go编码规范的，还可以将静态代码检查集成到CI/CD流程中。这样，在代码提交后自动地检查代码，就保证了只有符合编码规范的代码，才会被合入主干。</p><p>Go语言的静态代码检查工具有很多，目前用的最多的是<a target="_blank" rel="noopener noreferrer" href="https://github.com/golangci/golangci-lint">golangci-lint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这也是我极力推荐你使用的一个工具。关于这个工具的使用，我会在<strong>第15讲</strong>和你详细介绍。</p><p>除了遵循编码规范，<strong>要想成为Go编程高手，你还得学习并遵循一些最佳实践</strong>。“最佳实践”是社区经过多年探索沉淀下来的、符合Go语言特色的经验和共识，它可以帮助你开发出一个高质量的代码。</p><p>这里我给你推荐几篇介绍Go语言最佳实践的文章，供你参考：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://golang.org/doc/effective_go">Effective Go<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：高效Go编程，由Golang官方编写，里面包含了编写Go代码的一些建议，也可以理解为最佳实践。</li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/golang/go/wiki/CodeReviewComments">Go Code Review Comments<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：Golang官方编写的Go最佳实践，作为Effective Go的补充。</li><li><a target="_blank" rel="noopener noreferrer" href="https://rakyll.org/style-packages/">Style guideline for Go packages<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：包含了如何组织Go包、如何命名Go包、如何写Go包文档的一些建议。</li></ul><h3 id="代码质量"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#代码质量"><span class="icon icon-link"></span></a>代码质量</h3><p>有了组织合理的代码结构、符合Go语言代码规范的Go应用代码之后，我们还需要通过一些手段来确保我们开发出的是一个高质量的代码，这可以通过单元测试和Code Review来实现。</p><p>**单元测试非常重要。**我们开发完一段代码后，第一个执行的测试就是单元测试。它可以保证我们的代码是符合预期的，一些异常变动能够被及时感知到。进行单元测试，不仅需要编写单元测试用例，还需要我们确保代码是可测试的，以及具有一个高的单元测试覆盖率。</p><p>接下来，我就来介绍下如何编写一个可测试的代码。</p><p>如果我们要对函数A进行测试，并且A中的所有代码均能够在单元测试环境下按预期被执行，那么函数A的代码块就是可测试的。我们来看下一般的单元测试环境有什么特点：</p><ul><li>可能无法连接数据库。</li><li>可能无法访问第三方服务。</li></ul><p>如果函数A依赖数据库连接、第三方服务，那么在单元测试环境下执行单元测试就会失败，函数就没法测试，函数是不可测的。</p><p>解决方法也很简单：将依赖的数据库、第三方服务等抽象成接口，在被测代码中调用接口的方法，在测试时传入mock类型，从而将数据库、第三方服务等依赖从具体的被测函数中解耦出去。如下图所示：</p><p><img src="data:image/png;base64,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" alt=""/></p><p>为了提高代码的可测性，降低单元测试的复杂度，对function和mock的要求是：</p><ul><li>要尽可能减少function中的依赖，让function只依赖必要的模块。编写一个功能单一、职责分明的函数，会有利于减少依赖。</li><li>依赖模块应该是易Mock的。</li></ul><p>为了协助你理解，我们先来看一段不可测试的代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">package post</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    import &quot;google.golang.org/grpc&quot;</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    type Post struct {</span></div><div class="token-line"><span class="token plain">    	Name    string</span></div><div class="token-line"><span class="token plain">    	Address string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func ListPosts(client *grpc.ClientConn) ([]*Post, error) {</span></div><div class="token-line"><span class="token plain">    	return client.ListPosts()</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这段代码中的ListPosts函数是不可测试的。因为ListPosts函数中调用了<code>client.ListPosts()</code>方法，该方法依赖于一个gRPC连接。而我们在做单元测试时，可能因为没有配置gRPC服务的地址、网络隔离等原因，导致没法建立gRPC连接，从而导致ListPosts函数执行失败。</p><p>下面，我们把这段代码改成可测试的，如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">package main</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    type Post struct {</span></div><div class="token-line"><span class="token plain">    	Name    string</span></div><div class="token-line"><span class="token plain">    	Address string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    type Service interface {</span></div><div class="token-line"><span class="token plain">    	ListPosts() ([]*Post, error)</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func ListPosts(svc Service) ([]*Post, error) {</span></div><div class="token-line"><span class="token plain">    	return svc.ListPosts()</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>上面代码中，ListPosts函数入参为Service接口类型，只要我们传入一个实现了Service接口类型的实例，ListPosts函数即可成功运行。因此，我们可以在单元测试中可以实现一个不依赖任何第三方服务的fake实例，并传给ListPosts。上述可测代码的单元测试代码如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">package main</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    import &quot;testing&quot;</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    type fakeService struct {</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func NewFakeService() Service {</span></div><div class="token-line"><span class="token plain">    	return &amp;fakeService{}</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func (s *fakeService) ListPosts() ([]*Post, error) {</span></div><div class="token-line"><span class="token plain">    	posts := make([]*Post, 0)</span></div><div class="token-line"><span class="token plain">    	posts = append(posts, &amp;Post{</span></div><div class="token-line"><span class="token plain">    		Name:    &quot;colin&quot;,</span></div><div class="token-line"><span class="token plain">    		Address: &quot;Shenzhen&quot;,</span></div><div class="token-line"><span class="token plain">    	})</span></div><div class="token-line"><span class="token plain">    	posts = append(posts, &amp;Post{</span></div><div class="token-line"><span class="token plain">    		Name:    &quot;alex&quot;,</span></div><div class="token-line"><span class="token plain">    		Address: &quot;Beijing&quot;,</span></div><div class="token-line"><span class="token plain">    	})</span></div><div class="token-line"><span class="token plain">    	return posts, nil</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func TestListPosts(t *testing.T) {</span></div><div class="token-line"><span class="token plain">    	fake := NewFakeService()</span></div><div class="token-line"><span class="token plain">    	if _, err := ListPosts(fake); err != nil {</span></div><div class="token-line"><span class="token plain">    		t.Fatal(&quot;list posts failed&quot;)</span></div><div class="token-line"><span class="token plain">    	}</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>当我们的代码可测之后，就可以借助一些工具来Mock需要的接口了。常用的Mock工具，有这么几个：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/golang/mock">golang/mock<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，是官方提供的Mock框架。它实现了基于interface的Mock功能，能够与Golang内置的testing包做很好的集成，是最常用的Mock工具。golang/mock提供了mockgen工具用来生成interface对应的Mock源文件。</li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/DATA-DOG/go-sqlmock">sqlmock<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，可以用来模拟数据库连接。数据库是项目中比较常见的依赖，在遇到数据库依赖时都可以用它。</li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/jarcoal/httpmock">httpmock<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，可以用来Mock HTTP请求。</li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/bouk/monkey">bouk/monkey<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，猴子补丁，能够通过替换函数指针的方式来修改任意函数的实现。如果golang/mock、sqlmock和httpmock这几种方法都不能满足我们的需求，我们可以尝试通过猴子补丁的方式来Mock依赖。可以这么说，猴子补丁提供了单元测试 Mock 依赖的最终解决方案。</li></ul><p>接下来，我们再一起看看<strong>如何提高我们的单元测试覆盖率</strong>。</p><p>当我们编写了可测试的代码之后，接下来就需要编写足够的测试用例，用来提高项目的单元测试覆盖率。这里我有以下两个建议供你参考：</p><ul><li>使用gotests工具自动生成单元测试代码，减少编写单元测试用例的工作量，将你从重复的劳动中解放出来。</li><li>定期检查单元测试覆盖率。你可以通过以下方法来检查：</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ go test -race -cover  -coverprofile=./coverage.out -timeout=10m -short -v ./...</span></div><div class="token-line"><span class="token plain">    $ go tool cover -func ./coverage.out</span></div></pre></div><p>执行结果如下：</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimaged289d2fae0aca602c7c33466411e39c49489.67a06bc7.png" alt=""/></p><p>在提高项目的单元测试覆盖率时，我们可以先提高单元测试覆盖率低的函数，之后再检查项目的单元测试覆盖率；如果项目的单元测试覆盖率仍然低于期望的值，可以再次提高单元测试覆盖率低的函数的覆盖率，然后再检查。以此循环，最终将项目的单元测试覆盖率优化到预期的值为止。</p><p>这里要注意，对于一些可能经常会变动的函数单元测试，覆盖率要达到100%。</p><p>说完了单元测试，我们再看看<strong>如何通过Code Review来保证代码质量。</strong></p><p>Code Review可以提高代码质量、交叉排查缺陷，并且促进团队内知识共享，是保障代码质量非常有效的手段。在我们的项目开发中，一定要建立一套持久可行的Code Review机制。</p><p>但在我的研发生涯中，发现很多团队没有建立有效的Code Review机制。这些团队都认可Code Review机制带来的好处，但是因为流程难以遵守，慢慢地Code Review就变成了形式主义，最终不了了之。其实，建立Code Review机制很简单，主要有3点：</p><ul><li>首先，确保我们使用的代码托管平台有Code Review的功能。比如，GitHub、GitLab这类代码托管平台都具备这种能力。</li><li>接着，建立一套Code Review规范，规定如何进行Code Review。</li><li>最后，也是最重要的，每次代码变更，相关开发人员都要去落实Code Review机制，并形成习惯，直到最后形成团队文化。</li></ul><p><strong>到这里我们可以小结一下：组织一个合理的代码结构、编写符合Go代码规范的代码、保证代码质量，在我看来都是编写高质量Go代码的外功。那内功是什么呢？就是编程哲学和软件设计方法。</strong></p><h3 id="编程哲学"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#编程哲学"><span class="icon icon-link"></span></a>编程哲学</h3><p>那编程哲学是什么意思呢？在我看来，编程哲学，其实就是要编写符合Go语言设计哲学的代码。Go语言有很多设计哲学，对代码质量影响比较大的，我认为有两个：面向接口编程和面向“对象”编程。</p><p>我们先来看下面向接口编程。</p><p>Go 接口是一组方法的集合。任何类型，只要实现了该接口中的方法集，那么就属于这个类型，也称为实现了该接口。</p><p>接口的作用，其实就是为不同层级的模块提供一个定义好的中间层。这样，上游不再需要依赖下游的具体实现，充分地对上下游进行了解耦。很多流行的Go设计模式，就是通过面向接口编程的思想来实现的。</p><p>我们看一个面向接口编程的例子。下面这段代码定义了一个<code>Bird</code>接口，Canary和Crow类型均实现了<code>Bird</code>接口。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">package main</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    import &quot;fmt&quot;</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 定义了一个鸟类</span></div><div class="token-line"><span class="token plain">    type Bird interface {</span></div><div class="token-line"><span class="token plain">    	Fly()</span></div><div class="token-line"><span class="token plain">    	Type() string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 鸟类：金丝雀</span></div><div class="token-line"><span class="token plain">    type Canary struct {</span></div><div class="token-line"><span class="token plain">    	Name string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func (c *Canary) Fly() {</span></div><div class="token-line"><span class="token plain">    	fmt.Printf(&quot;我是%s，用黄色的翅膀飞\n&quot;, c.Name)</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    func (c *Canary) Type() string {</span></div><div class="token-line"><span class="token plain">    	return c.Name</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 鸟类：乌鸦</span></div><div class="token-line"><span class="token plain">    type Crow struct {</span></div><div class="token-line"><span class="token plain">    	Name string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func (c *Crow) Fly() {</span></div><div class="token-line"><span class="token plain">    	fmt.Printf(&quot;我是%s，我用黑色的翅膀飞\n&quot;, c.Name)</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func (c *Crow) Type() string {</span></div><div class="token-line"><span class="token plain">    	return c.Name</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 让鸟类飞一下</span></div><div class="token-line"><span class="token plain">    func LetItFly(bird Bird) {</span></div><div class="token-line"><span class="token plain">    	fmt.Printf(&quot;Let %s Fly!\n&quot;, bird.Type())</span></div><div class="token-line"><span class="token plain">    	bird.Fly()</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func main() {</span></div><div class="token-line"><span class="token plain">    	LetItFly(&amp;Canary{&quot;金丝雀&quot;})</span></div><div class="token-line"><span class="token plain">    	LetItFly(&amp;Crow{&quot;乌鸦&quot;})</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这段代码中，因为Crow和Canary都实现了Bird接口声明的Fly、Type方法，所以可以说Crow、Canary实现了Bird接口，属于Bird类型。在函数调用时，可以传入Bird类型，并在函数内部调用Bird接口提供的方法，以此来解耦Bird的具体实现。</p><p>好了，我们总结下使用接口的好处吧：</p><ul><li>代码扩展性更强了。例如，同样的Bird，可以有不同的实现。在开发中用的更多的是，将数据库的CURD操作抽象成接口，从而可以实现同一份代码对接不同数据库的目的。</li><li>可以解耦上下游的实现。例如，LetItFly不用关注Bird是如何Fly的，只需要调用Bird提供的方法即可。</li><li>提高了代码的可测性。因为接口可以解耦上下游实现，我们在单元测试需要依赖第三方系统/数据库的代码时，可以利用接口将具体实现解耦，实现fake类型。</li><li>代码更健壮、更稳定了。例如，如果要更改Fly的方式，只需要更改相关类型的Fly方法即可，完全影响不到LetItFly函数。</li></ul><p>所以，我建议你，在Go项目开发中，一定要多思考，那些可能有多种实现的地方，要考虑使用接口。</p><p>接下来，我们再来看下面向“对象”编程。</p><p>面向对象编程（OOP）有很多优点，例如可以使我们的代码变得易维护、易扩展，并能提高开发效率等，所以一个高质量的Go应用在需要时，也应该采用面向对象的方法去编程。那什么叫“在需要时”呢？就是我们在开发代码时，如果一个功能可以通过接近于日常生活和自然的思考方式来实现，这时候就应该考虑使用面向对象的编程方法。</p><p>Go语言不支持面向对象编程，但是却可以通过一些语言级的特性来实现类似的效果。</p><p>面向对象编程中，有几个核心特性：类、实例、抽象，封装、继承、多态、构造函数、析构函数、方法重载、this指针。在Go中可以通过以下几个方式来实现类似的效果：</p><ul><li>类、抽象、封装通过结构体来实现。</li><li>实例通过结构体变量来实现。</li><li>继承通过组合来实现。这里解释下什么叫组合：一个结构体嵌到另一个结构体，称作组合。例如一个结构体包含了一个匿名结构体，就说这个结构体组合了该匿名结构体。</li><li>多态通过接口来实现。</li></ul><p>至于构造函数、析构函数、方法重载和this指针等，Go为了保持语言的简洁性去掉了这些特性。</p><p>Go中面向对象编程方法，见下图：</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage27b827c84757b1f4626e84535d994ca70eb8.77ac9b87.png" alt=""/></p><p>我们通过一个示例，来具体看下Go是如何实现面向对象编程中的类、抽象、封装、继承和多态的。代码如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">package main</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    import &quot;fmt&quot;</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 基类：Bird</span></div><div class="token-line"><span class="token plain">    type Bird struct {</span></div><div class="token-line"><span class="token plain">    	Type string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 鸟的类别</span></div><div class="token-line"><span class="token plain">    func (bird *Bird) Class() string {</span></div><div class="token-line"><span class="token plain">    	return bird.Type</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 定义了一个鸟类</span></div><div class="token-line"><span class="token plain">    type Birds interface {</span></div><div class="token-line"><span class="token plain">    	Name() string</span></div><div class="token-line"><span class="token plain">    	Class() string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 鸟类：金丝雀</span></div><div class="token-line"><span class="token plain">    type Canary struct {</span></div><div class="token-line"><span class="token plain">    	Bird</span></div><div class="token-line"><span class="token plain">    	name string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func (c *Canary) Name() string {</span></div><div class="token-line"><span class="token plain">    	return c.name</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    // 鸟类：乌鸦</span></div><div class="token-line"><span class="token plain">    type Crow struct {</span></div><div class="token-line"><span class="token plain">    	Bird</span></div><div class="token-line"><span class="token plain">    	name string</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func (c *Crow) Name() string {</span></div><div class="token-line"><span class="token plain">    	return c.name</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func NewCrow(name string) *Crow {</span></div><div class="token-line"><span class="token plain">    	return &amp;Crow{</span></div><div class="token-line"><span class="token plain">    		Bird: Bird{</span></div><div class="token-line"><span class="token plain">    			Type: &quot;Crow&quot;,</span></div><div class="token-line"><span class="token plain">    		},</span></div><div class="token-line"><span class="token plain">    		name: name,</span></div><div class="token-line"><span class="token plain">    	}</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func NewCanary(name string) *Canary {</span></div><div class="token-line"><span class="token plain">    	return &amp;Canary{</span></div><div class="token-line"><span class="token plain">    		Bird: Bird{</span></div><div class="token-line"><span class="token plain">    			Type: &quot;Canary&quot;,</span></div><div class="token-line"><span class="token plain">    		},</span></div><div class="token-line"><span class="token plain">    		name: name,</span></div><div class="token-line"><span class="token plain">    	}</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func BirdInfo(birds Birds) {</span></div><div class="token-line"><span class="token plain">    	fmt.Printf(&quot;I&#x27;m %s, I belong to %s bird class!\n&quot;, birds.Name(), birds.Class())</span></div><div class="token-line"><span class="token plain">    }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    func main() {</span></div><div class="token-line"><span class="token plain">        canary := NewCanary(&quot;CanaryA&quot;)</span></div><div class="token-line"><span class="token plain">        crow := NewCrow(&quot;CrowA&quot;)</span></div><div class="token-line"><span class="token plain">    	BirdInfo(canary)</span></div><div class="token-line"><span class="token plain">    	BirdInfo(crow)</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>将上述代码保存在oop.go文件中，执行以下代码输出如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ go run oop.go</span></div><div class="token-line"><span class="token plain">    I&#x27;m CanaryA, I belong to Canary bird class!</span></div><div class="token-line"><span class="token plain">    I&#x27;m CrowA, I belong to Crow bird class!</span></div></pre></div><p>在上面的例子中，分别通过Canary和Crow结构体定义了金丝雀和乌鸦两种类别的鸟，其中分别封装了name属性和Name方法。也就是说通过结构体实现了类，该类抽象了鸟类，并封装了该鸟类的属性和方法。</p><p>在Canary和Crow结构体中，都有一个Bird匿名字段，Bird字段为Canary和Crow类的父类，Canary和Crow继承了Bird类的Class属性和方法。也就是说通过匿名字段实现了继承。</p><p>在main函数中，通过NewCanary创建了Canary鸟类实例，并将其传给BirdInfo函数。也就是说通过结构体变量实现实例。</p><p>在BirdInfo函数中，将Birds接口类型作为参数传入，并在函数中调用了birds.Name，birds.Class方法，这两个方法会根据birds类别的不同而返回不同的名字和类别，也就是说通过接口实现了多态。</p><h3 id="软件设计方法"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#软件设计方法"><span class="icon icon-link"></span></a>软件设计方法</h3><p>接下来，我们继续学习编写高质量Go代码的第二项内功，也就是让编写的代码遵循一些业界沉淀下来的，优秀的软件设计方法。</p><p>优秀的软件设计方法有很多，其中有两类方法对我们代码质量的提升特别有帮助，分别是设计模式（Design pattern）和SOLID原则。</p><p>在我看来，设计模式可以理解为业界针对一些特定的场景总结出来的最佳实现方式。它的特点是解决的场景比较具体，实施起来会比较简单；而SOLID原则更侧重设计原则，需要我们彻底理解，并在编写代码时多思考和落地。</p><p>关于设计模式和SOLID原则，我是这么安排的：在<strong>第11讲</strong>，我会带你学习Go项目常用的设计模式；至于SOLID原则，网上已经有很多高质量的文章了，所以我会简单告诉你这个原则是啥，然后给你推荐一篇介绍文章。</p><p>我们先了解下有哪些设计模式。</p><p>在软件领域，沉淀了一些比较优秀的设计模式，其中最受欢迎的是GOF设计模式。GOF设计模式中包含了3大类（创建型模式、结构型模式、行为型模式），共25种经典的、可以解决常见软件设计问题的设计方案。这25种设计方案同样也适用于Go语言开发的项目。</p><p>这里，我将这25种设计模式总结成了一张图，你可以先看看，有个大概的印象，对于一些在Go项目开发中常用的设计模式，我会在<strong>第11讲</strong>详细介绍。</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage149c1440f4bbcda682c8f5e7a599c8c51f9c.330b0bf7.png" alt=""/></p><p><strong>如果说设计模式解决的是具体的场景，那么SOLID原则就是我们设计应用代码时的指导方针。</strong></p><p>SOLID原则，是由罗伯特·C·马丁在21世纪早期引入的，包括了面向对象编程和面向对象设计的五个基本原则：</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage193b19b697bbbe31450d6cc8f222491d3e3b.1b213d66.png" alt=""/></p><p>遵循SOLID原则可以确保我们设计的代码是易维护、易扩展、易阅读的。SOLID原则同样也适用于Go程序设计。</p><p>如果你需要更详细地了解SOLID原则，可以参考下<a target="_blank" rel="noopener noreferrer" href="https://github.com/marmotedu/geekbang-go/blob/master/SOLID%E5%8E%9F%E5%88%99%E4%BB%8B%E7%BB%8D.md">SOLID原则介绍<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>这篇文章。</p><p>到这里，我们就学完了“编写高质量的Go应用”这部分内容。接下来，我们再来学习下如何高效管理Go项目，以及如何编写高质量的项目文档。这里面的大部分内容，之前我们都有学习过，因为它们是“如何写出优雅的Go项目”的重要组成部分，所以，这里我仍然会简单介绍下它们。</p><h2 id="高效管理项目"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#高效管理项目"><span class="icon icon-link"></span></a>高效管理项目</h2><p>一个优雅的Go项目，还需要具备高效的项目管理特性。那么如何高效管理我们的项目呢？</p><p>不同团队、不同项目会采用不同的方法来管理项目，在我看来比较重要的有3点，分别是制定一个高效的开发流程、使用Makefile管理项目和将项目管理自动化。我们可以通过自动生成代码、借助工具、对接CI/CD系统等方法来将项目管理自动化。具体见下图：</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage616d61e022c1b25dab2b0fefb407fc1c776d.c226e4cd.png" alt=""/></p><h3 id="高效的开发流程"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#高效的开发流程"><span class="icon icon-link"></span></a>高效的开发流程</h3><p>高效管理项目的第一步，就是要有一个高效的开发流程，这可以提高开发效率、减少软件维护成本。你可以回想一下设计开发流程的知识，如果印象比较模糊了，一定要回去复习下<strong>08讲</strong>的内容**，**因为这部分很重要 。</p><h3 id="使用makefile管理项目"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#使用makefile管理项目"><span class="icon icon-link"></span></a>使用Makefile管理项目</h3><p>为了更好地管理项目，除了一个高效的开发流程之外，使用Makefile也很重要。Makefile可以将项目管理的工作通过Makefile依赖的方式实现自动化，除了可以提高管理效率之外，还能够减少人为操作带来的失误，并统一操作方式，使项目更加规范。</p><p>IAM项目的所有操作均是通过Makefile来完成的，具体Makefile完成了如下操作：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">build              Build source code for host platform.</span></div><div class="token-line"><span class="token plain">      build.multiarch    Build source code for multiple platforms. See option PLATFORMS.</span></div><div class="token-line"><span class="token plain">      image              Build docker images for host arch.</span></div><div class="token-line"><span class="token plain">      image.multiarch    Build docker images for multiple platforms. See option PLATFORMS.</span></div><div class="token-line"><span class="token plain">      push               Build docker images for host arch and push images to registry.</span></div><div class="token-line"><span class="token plain">      push.multiarch     Build docker images for multiple platforms and push images to registry.</span></div><div class="token-line"><span class="token plain">      deploy             Deploy updated components to development env.</span></div><div class="token-line"><span class="token plain">      clean              Remove all files that are created by building.</span></div><div class="token-line"><span class="token plain">      lint               Check syntax and styling of go sources.</span></div><div class="token-line"><span class="token plain">      test               Run unit test.</span></div><div class="token-line"><span class="token plain">      cover              Run unit test and get test coverage.</span></div><div class="token-line"><span class="token plain">      release            Release iam</span></div><div class="token-line"><span class="token plain">      format             Gofmt (reformat) package sources (exclude vendor dir if existed).</span></div><div class="token-line"><span class="token plain">      verify-copyright   Verify the boilerplate headers for all files.</span></div><div class="token-line"><span class="token plain">      add-copyright      Ensures source code files have copyright license headers.</span></div><div class="token-line"><span class="token plain">      gen                Generate all necessary files, such as error code files.</span></div><div class="token-line"><span class="token plain">      ca                 Generate CA files for all iam components.</span></div><div class="token-line"><span class="token plain">      install            Install iam system with all its components.</span></div><div class="token-line"><span class="token plain">      swagger            Generate swagger document.</span></div><div class="token-line"><span class="token plain">      serve-swagger      Serve swagger spec and docs.</span></div><div class="token-line"><span class="token plain">      dependencies       Install necessary dependencies.</span></div><div class="token-line"><span class="token plain">      tools              install dependent tools.</span></div><div class="token-line"><span class="token plain">      check-updates      Check outdated dependencies of the go projects.</span></div><div class="token-line"><span class="token plain">      help               Show this help info.</span></div></pre></div><h3 id="自动生成代码"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#自动生成代码"><span class="icon icon-link"></span></a>自动生成代码</h3><p>低代码的理念现在越来越流行。虽然低代码有很多缺点，但确实有很多优点，例如：</p><ul><li>自动化生成代码，减少工作量，提高工作效率。</li><li>代码有既定的生成规则，相比人工编写代码，准确性更高、更规范。</li></ul><p>目前来看，自动生成代码现在已经成为趋势，比如 Kubernetes项目有很多代码都是自动生成的。我认为，想写出一个优雅的Go项目，你也应该认真思考哪些地方的代码可以自动生成。在这门课的IAM项目中，就有大量的代码是自动生成的，我放在这里供你参考：</p><ul><li>错误码、错误码说明文档。</li><li>自动生成缺失的doc.go文件。</li><li>利用gotests工具，自动生成单元测试用例。</li><li>使用Swagger工具，自动生成Swagger文档。</li><li>使用Mock工具，自动生成接口的Mock实例。</li></ul><h3 id="善于借助工具"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#善于借助工具"><span class="icon icon-link"></span></a>善于借助工具</h3><p>在开发Go项目的过程中，我们也要善于借助工具，来帮助我们完成一部分工作。利用工具可以带来很多好处：</p><ul><li>解放双手，提高工作效率。</li><li>利用工具的确定性，可以确保执行结果的一致性。例如，使用golangci-lint对代码进行检查，可以确保不同开发者开发的代码至少都遵循golangci-lint的代码检查规范。</li><li>有利于实现自动化，可以将工具集成到CI/CD流程中，触发流水线自动执行。</li></ul><p>那么，Go项目中，有哪些工具可以为我们所用呢？这里，我给你整理了一些有用的工具：</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimage908090ca527c2863fe642f9ab3d5b90fe980.5fb75a76.png" alt=""/></p><p>所有这些工具都可以通过下面的方式安装。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ cd $IAM_ROOT</span></div><div class="token-line"><span class="token plain">    $ make tools.install</span></div></pre></div><p>IAM项目使用了上面这些工具的绝大部分，用来尽可能提高整个项目的自动化程度，提高项目维护效率。</p><h3 id="对接cicd"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#对接cicd"><span class="icon icon-link"></span></a>对接CI/CD</h3><p>代码在合并入主干时，应该有一套CI/CD流程来自动化地对代码进行检查、编译、单元测试等，只有通过后的代码才可以并入主干。通过CI/CD流程来保证代码的质量。当前比较流行的CI/CD工具有Jenkins、GitLab、Argo、Github Actions、JenkinsX等。在<strong>第51讲</strong> 和 <strong>第52讲</strong>中，我会详细介绍CI/CD的原理和实战。</p><h2 id="编写高质量的项目文档"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#编写高质量的项目文档"><span class="icon icon-link"></span></a>编写高质量的项目文档</h2><p>最后，一个优雅的项目，还应该有完善的文档。例如 README.md、安装文档、开发文档、使用文档、API接口文档、设计文档等等。这些内容在<a target="_blank" rel="noopener noreferrer" href="https://time.geekbang.org/column/article/380033">第04讲<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的文档规范部分有详细介绍，你可以去复习下。</p><h2 id="总结"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#总结"><span class="icon icon-link"></span></a>总结</h2><p>使用Go语言做项目开发，核心目的其实就是<strong>开发一个优雅的Go项目</strong>。那么如何开发一个优雅的Go项目呢？Go项目包含三大内容，即 Go应用、项目管理、项目文档，因此开发一个优雅的Go项目，其实就是<strong>编写高质量的Go应用</strong>、<strong>高效管理项目</strong>和<strong>编写高质量的项目文档</strong>。针对每一项，我都给出了一些实现方式，这些方式详见下图：</p><p><img src="/blog-backend/static/httpsstatic001geekbangorgresourceimageb0ccb051da025c897996473df44693ea4ecc.c1311fd6.png" alt=""/></p><h2 id="课后练习"><a aria-hidden="true" tabindex="-1" href="/blog-backend/go语言项目开发实战/03.实战第1站规范设计/07#课后练习"><span class="icon icon-link"></span></a>课后练习</h2><ol><li>在工作中，你还有哪些方法，来帮助你开发一个优雅的Go项目呢？</li><li>在你的当前项目中有哪些可以接口化的代码呢？找到它们，并尝试用面向接口的编程哲学去重写这部分代码吧。</li></ol><p>期待在留言区看到你的思考和答案，我们下一讲见！</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/go语言项目开发实战/03.实战第1站规范设计/07.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/27 11:15:40</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-backend/umi.e14e5a14.js"></script>
  </body>
</html>
